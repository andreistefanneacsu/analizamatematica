<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mock Exam Portal</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { background: linear-gradient(to right, #eef2ff, #f5f3ff); }
section { transition: all 0.4s ease; }
.fade-out { opacity: 0; transform: scale(0.95); pointer-events: none; }
.timer { font-weight: bold; display: none; }
.attempt-info { font-weight: 500; color: #4b5563; }
.pdf-list { max-height: 300px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 10px; margin-top:10px; }
.pdf-item { margin-bottom: 6px; }
</style>
</head>
<body class="min-h-screen flex flex-col items-center justify-between p-4">

<div id="app" class="w-full max-w-4xl bg-white shadow-2xl rounded-3xl p-8 space-y-6 mt-6">

<h1 class="text-3xl font-bold text-center text-indigo-700 mb-6">Mock Exam Portal</h1>

<!-- Login Section -->
<div id="login" class="space-y-4">
<label class="block text-gray-700 font-medium">Username</label>
<input id="username" class="w-full p-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-400 outline-none" autocomplete="username">
<label class="block text-gray-700 font-medium">Password</label>
<input id="password" type="password" class="w-full p-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-indigo-400 outline-none" autocomplete="current-password">
<button onclick="login()" class="w-full bg-indigo-600 text-white font-semibold py-3 rounded-xl hover:bg-indigo-700 transition">Login</button>
<button onclick="requestAccess()" class="w-full bg-gray-200 text-gray-700 font-medium py-2 rounded-xl hover:bg-gray-300 transition">Request Access</button>
<p id="loginError" class="text-red-600 font-medium"></p>
</div>

<!-- Exam Section -->
<div id="exam" class="hidden space-y-6">

<div class="flex justify-between items-center">
<div>
<h2 id="welcome" class="text-xl font-semibold text-indigo-800"></h2>
<p id="hint" class="text-sm text-gray-500">Start each section when ready — timer appears after starting.</p>
</div>
<div>
<p id="attemptInfo" class="attempt-info"></p>
<button onclick="logout()" class="px-4 py-2 bg-red-100 text-red-700 font-medium rounded-xl hover:bg-red-200 transition">Logout</button>
</div>
</div>

<!-- Admin PDF List Section -->
<div id="adminPDFSection" class="hidden p-4 bg-gray-50 rounded-xl shadow space-y-3">
<button id="togglePDFListBtn" onclick="toggleAdminPDFList()" class="bg-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300">See PDF List</button>
<div id="adminPDFList" class="pdf-list hidden"></div>
</div>

<!-- Theory Section -->
<section id="theorySection" class="p-5 bg-indigo-50 rounded-2xl shadow-md space-y-3">
<div class="flex justify-between items-center">
<h3 class="text-lg font-semibold text-indigo-700">Theory Section <span id="theoryTimer" class="ml-2 timer">00:00</span></h3>
<button id="startTheory" onclick="startTimer('theory')" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">Start Theory</button>
</div>
<div id="theoryPdfContainer" class="hidden mt-3">
<iframe id="theoryPdf" class="w-full h-96 rounded-xl border"></iframe>
</div>
</section>

<!-- Exercises Section -->
<section id="exSection" class="p-5 bg-purple-50 rounded-2xl shadow-md space-y-3">
<div class="flex justify-between items-center">
<h3 class="text-lg font-semibold text-purple-700">Exercises Section <span id="exTimer" class="ml-2 timer">00:00</span></h3>
<button id="startEx" onclick="startTimer('ex')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">Start Exercises</button>
</div>
<div id="exPdfContainer" class="hidden mt-3">
<iframe id="exPdf" class="w-full h-96 rounded-xl border"></iframe>
</div>
</section>

<!-- Finish Exam -->
<div id="finishExamContainer" class="hidden">
<button onclick="finishExam()" id="finishExamBtn" class="w-full bg-green-600 text-white font-semibold py-3 rounded-xl hover:bg-green-700 transition">Finish Exam</button>
</div>

<!-- Upload card (only for non-admin users) -->
<div id="uploadCard" class="hidden p-6 bg-white border rounded-2xl shadow-sm text-center">
<p id="uploadName" class="text-gray-700 font-semibold mb-3"></p>
<button id="openFolderBtn" class="px-6 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition" target="_blank" rel="noopener">Open Upload Folder</button>
<button onclick="resetPortal()" id="retakeBtn" class="mt-4 px-6 py-3 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition">Retake Exam</button>
</div>

</div>
</div>

<footer>
University of Bucharest — Faculty of Mathematics and Computer Science
</footer>

<script>
// --- USERS ---
const USERS = {
  admin: { password: "admin", name: "Admin", group: null, driveFolder: "", tries: null },
  
  // Grupa 161
  oabalan: { password: "XzeZ2CGy5TDB89hf", name: "Bălan Otniel-Andrei", group: 161, driveFolder: "https://drive.google.com/drive/folders/1CrwloacF_JcLb04_kKlvdwtCVWwDTLJ4?usp=sharing", tries: 3 },
  mechelan: { password: "QDhV!Nu&rZMkm7?9", name: "Chelan Maria-Estera", group: 161, driveFolder: "https://drive.google.com/drive/folders/1wDLkZpD5JHMf0uQG8oEXmK8MWyJalblg?usp=sharing", tries: 3 },
  rachelu: { password: "!gfdZdPa6+%gZ6q7", name: "Chelu Radu-Andrei", group: 161, driveFolder: "https://drive.google.com/drive/folders/12s4qZ8GHPviLM9DyJpZ6UKiH67QSYCsv?usp=sharing", tries: 3 },
  aciuvica: { password: "J-6g$-86TDQD4%Dn", name: "Ciuvică Alexandru", group: 161, driveFolder: "https://drive.google.com/drive/folders/1XHXTZOe0WEnwd3CvFLUtKzry4msDTAIB?usp=sharing", tries: 3 },
  eddragnea: { password: "V9cpngS5%?jbwqx-", name: "Dragnea Edward-Dorian", group: 161, driveFolder: "https://drive.google.com/drive/folders/1bWkDxDr6zICfEyYrQ7ToV8bsUnEzCRAY?usp=sharing", tries: 3 },
  aaflueraru: { password: "W@?ZEAnCGjG-@aN9", name: "Flueraru Alexandru-Achille", group: 161, driveFolder: "https://drive.google.com/drive/folders/1X-n6f4v3A12WrEut8twUbwBsP4aTEkgE?usp=sharing", tries: 3 },
  dgaina: { password: "*b2P#5xrsemvXJ-G", name: "Găină David", group: 161, driveFolder: "https://drive.google.com/drive/folders/1xGqtlMkTi3U3QeGQwskn9CKzBYeWP_q1?usp=sharing", tries: 3 },
  mdneculae: { password: "ZYGSyVKsuS@c@jTX", name: "Neculae Mara-Daniela", group: 161, driveFolder: "https://drive.google.com/drive/folders/1gWBkMAgCGvHl6JO7rj_plOqA2Q7Cb9Xm?usp=sharing", tries: 3 },
  snegrila: { password: "AmC$7aS9W?hu3Hfe", name: "Negrilă Ștefan", group: 161, driveFolder: "https://drive.google.com/drive/folders/1l9aBcv5fsvEYNR74eggSnEgTZcoRgo9W?usp=sharing", tries: 3 },
  rspelea: { password: "WWn27*H+4VAP4EaS", name: "Pelea Radu-Ștefan", group: 161, driveFolder: "https://drive.google.com/drive/folders/1wK5wwgC01sxyOxWFlxfUxVm5igrCrIcv?usp=sharing", tries: 3 },
  grusanescu: { password: "Y3bb6-GF-HsZM4N@", name: "Rusănescu Gabriel", group: 161, driveFolder: "https://drive.google.com/drive/folders/1b8XFNr5QLVet-cK6xri58ymd4VUgpoKa?usp=sharing", tries: 3 },
  acruse: { password: "+%Y6%4@Tav-vmnm9", name: "Ruse Alexandru-Cristian", group: 161, driveFolder: "https://drive.google.com/drive/folders/1ANEvpC0qPxkOiT5nw0qONhY1IXZ3dWam?usp=sharing", tries: 3 },
  ccsarofin: { password: "eu+HmEKQxqfT$4z2", name: "Sarofin Cristian-Constantin", group: 161, driveFolder: "https://drive.google.com/drive/folders/1qQmf7phJ-ANDPi3jOBFeXI5zDz_6ziKk?usp=sharing", tries: 3 },
  igsirbu: { password: "Vc-zNGFf+DwX9Vws", name: "Sîrbu Iulia-Georgiana", group: 161, driveFolder: "https://drive.google.com/drive/folders/1kpAvTr5v9Bl-uArSE73ksLKlTu6Jx8Wx?usp=sharing", tries: 3 },
  dastinga: { password: "FXYQ#MXvHvz?Q?eH", name: "Stîngă David-Andrei", group: 161, driveFolder: "https://drive.google.com/drive/folders/1eT3RcJ2d9lqfYqwkYijAXEVxQiC77mjI?usp=sharing", tries: 3 },
  mfsturzoiu: { password: "26n5a2zREHAb+eu3", name: "Sturzoiu Maria-Filofteia", group: 161, driveFolder: "https://drive.google.com/drive/folders/1aPMjMtNxP6qbknleA7yeniP6IbvMgPlq?usp=sharing", tries: 3 },
  desuciu: { password: "3PN2$%kjVRP*vrBv", name: "Suciu Dragos-Emanuel", group: 161, driveFolder: "https://drive.google.com/drive/folders/1pJSDSWDqeOSMIQ0sell0U23LXFcN2cDI?usp=sharing", tries: 3 },
  cudroiu: { password: "cQJF?!BHvNSNEjqb", name: "Udroiu Cristian", group: 161, driveFolder: "https://drive.google.com/drive/folders/12x9DU11M26Hi2HiGrTNPIO7FzLGUryR5?usp=sharing", tries: 3 },
  mvisanescu: { password: "ZVNxdg$cqf-Q?rHv", name: "Vișănescu Mihai", group: 161, driveFolder: "https://drive.google.com/drive/folders/1jkc_TJLaKcBSUxlje6qWHD4YVAEbEBC9?usp=sharing", tries: 3 },
  
  // Grupa 162
  aebulubasa: { password: "6a43RX&AH+ZwDM+$", name: "Bulubașa Alexia-Elena", group: 162, driveFolder: "https://drive.google.com/drive/folders/1cWc1l9YcpQcvnqDgn90xCQ_-GkHeG0pm?usp=sharing", tries: 3 },
  crcirciumaru: { password: "+-Z-!TC8G6Jq7WeY", name: "Cîrciumaru Cristian-Radu", group: 162, driveFolder: "https://drive.google.com/drive/folders/111jfg9dpbSRhnmao6FeFkJ-e3WIo6tas?usp=sharing", tries: 3 },
  frconstantinescu: { password: "BKkg4DzvNVzfn3Tf", name: "Constantinescu Florian-Robert", group: 162, driveFolder: "https://drive.google.com/drive/folders/1sCCH7_-P2JOTqPKhXxj4GizEMRt0o1ac?usp=sharing", tries: 3 },
  sadominte: { password: "aw&w9+yhA9!dsg4@", name: "Dominte Ștefan-Alexandru", group: 162, driveFolder: "https://drive.google.com/drive/folders/1Xbo7eU9_MXHk-YMBcQz3g-n5hmiFX-IU?usp=sharing", tries: 3 },
  dcfloroiu: { password: "2hn5u6!zhDsaE+y3", name: "Floroiu David-Cristian", group: 162, driveFolder: "https://drive.google.com/drive/folders/1KGHw-WNTindH-TOqDgdPTOSr5gF_0Uu0?usp=sharing", tries: 3 },
  aagheorghe: { password: "XbEg&ZXy65%c!7CS", name: "Gheorghe Alexa-Andreea", group: 162, driveFolder: "https://drive.google.com/drive/folders/1S58Zxo91kOZ9bkYT-06JVVYZ4UBcNV5H?usp=sharing", tries: 3 },
  ergheorghe: { password: "fu%RZ7t*nnXXTaW6", name: "Gheorghe Elena-Rebecca", group: 162, driveFolder: "https://drive.google.com/drive/folders/1vRTbwbfAADj5Ik8Nb1Toxbt1Y1OaD8Vb?usp=sharing", tries: 3 },
  aagherghe: { password: "rA#SWxByA5$YR4Wb", name: "Gherghe Ana-Alexandra", group: 162, driveFolder: "https://drive.google.com/drive/folders/1KU1iArQwWSIDikXqRT9N2Z7gNXjjyK-n?usp=sharing", tries: 3 },
  migirla: { password: "ArrvF8Y#6FQZM6Ax", name: "Gîrlă Monica-Ioana", group: 162, driveFolder: "https://drive.google.com/drive/folders/1_U4H69yTRuu8iUF-OzLyRSuVuLb40F74?usp=sharing", tries: 3 },
  oivan: { password: "E%pm3*npvHPw4k$d", name: "Ivan Octavian", group: 162, driveFolder: "https://drive.google.com/drive/folders/1v9NtH5_2DL_-H18VvWOjdAW06sTeB83K?usp=sharing", tries: 3 },
  tsmatei: { password: "Epv3H5KQpFjT%cj#", name: "Matei Thea-Sorana", group: 162, driveFolder: "https://drive.google.com/drive/folders/1vktFI_sN7NYLBWTuF8sZ2_Z-Snssvn5c?usp=sharing", tries: 3 },
  aimihai: { password: "naTJYsR@#!@E!M8A", name: "Mihai Alessia-Ioana", group: 162, driveFolder: "https://drive.google.com/drive/folders/1yUhXjIv3tZFA-on7KEIy6oGl0OHTMz6t?usp=sharing", tries: 3 },
  ramoldovan: { password: "4Ytkm#GuXkM9q*Mk", name: "Moldovan Raluca-Andreea", group: 162, driveFolder: "https://drive.google.com/drive/folders/1tCuXCZ9Ryfv4gQ8_ZZNR-8KlRoMXTo7a?usp=sharing", tries: 3 },
  atnan: { password: "C8sEhpJP8mRNjp2C", name: "Nan Alexandra-Teodora", group: 162, driveFolder: "https://drive.google.com/drive/folders/1FXCWgmK-wc1v6zefTO5PjLDc1m-jFojr?usp=sharing", tries: 3 },
  vfpadeanu: { password: "KB$sBEezY?c-AE9Q", name: "Pădeanu Vlad-Florin", group: 162, driveFolder: "https://drive.google.com/drive/folders/141T2oVrlDVGtpGy_CGPMwF_p9wEY6uBu?usp=sharing", tries: 3 },
  ocristea: { password: "a#E#RRx!+ua#&$?4", name: "Ristea Octavian-Cristian", group: 162, driveFolder: "https://drive.google.com/drive/folders/1H4e3ymBunuQCI4NuG6efD6eECgSN6Rn_?usp=sharing", tries: 3 },
  rarolea: { password: "PhWS5BQ3RcQcwGC?", name: "Rolea Robert-Andrei", group: 162, driveFolder: "https://drive.google.com/drive/folders/1UdrCn1TaevvI2X6U8OsTIDWTyyNrsheI?usp=sharing", tries: 3 },
  masebacher: { password: "@Z*X6Ps4mCYwPvS?", name: "Sebacher Maria-Alexandra", group: 162, driveFolder: "https://drive.google.com/drive/folders/1L5ita-P7M_-ST3Nti_AzQIGPJcCSOGhf?usp=sharing", tries: 3 },
  lcstanescu: { password: "gj@GFnh4bGK-5KGJ", name: "Stănescu Liviu-Cristian", group: 162, driveFolder: "https://drive.google.com/drive/folders/1J_gB8AAwj_F1YNiD11DcgVf980YJPMxS?usp=sharing", tries: 3 },
  
  // Grupa 163
  acargherie: { password: "cSyr8YbSqdK-a8!&", name: "Argherie Andrei-Codrut", group: 163, driveFolder: "https://drive.google.com/drive/folders/16qQHcRLXFIk-MOF-JrnU7MeFeDqi_jdT?usp=sharing", tries: 3 },
  bcboboc: { password: "Kv8qY$HY6DMpA#Tp", name: "Boboc Bogdan-Costin", group: 163, driveFolder: "https://drive.google.com/drive/folders/1DVBDyzbUCS2ulYuKAbqA4lmddJ7dLwgt?usp=sharing", tries: 3 },
  rscimpoesu: { password: "b9eWzgXGchRPw7!#", name: "Cimpoeșu Rareș-Ștefan", group: 163, driveFolder: "https://drive.google.com/drive/folders/1H4GbUQmFXVjvXWwKbPlkz2rVGV9ue9E6?usp=sharing", tries: 3 },
  dgdorobantu: { password: "Qtq6Qds$G9VYYTjH", name: "Dorobanțu David-Gabriel", group: 163, driveFolder: "https://drive.google.com/drive/folders/1xWdyl5CIqCsJsqcwe5NQ96_SE_uj-MGB?usp=sharing", tries: 3 },
  agduta: { password: "wcuqpCMFR4rpn99x", name: "Duță Andrei-George", group: 163, driveFolder: "https://drive.google.com/drive/folders/1j99RsGgb6DyMBcCwbZOHdxXDFRDsxIGp?usp=sharing", tries: 3 },
  mmiancu: { password: "G5ZJ5!R4JG*DQmvx", name: "Iancu Mihnea-Matei", group: 163, driveFolder: "https://drive.google.com/drive/folders/1ndTGEjibclhGa9ji0QxQnLY42dgy4gnM?usp=sharing", tries: 3 },
  dmmatache: { password: "KHV#J8uF#mSvKQJW", name: "Matache David-Mihai", group: 163, driveFolder: "https://drive.google.com/drive/folders/1FpSBw6n0--lbjuMYZLb-6wyTXlCct8gD?usp=sharing", tries: 3 },
  vsmerticariu: { password: "af57bVT6UByGrP8?", name: "Merticariu Vlad-Ștefan", group: 163, driveFolder: "https://drive.google.com/drive/folders/1lmgsMoINHdDpD5_rmC5MSOfQIUTPISb-?usp=sharing", tries: 3 },
  kamiura: { password: "aGnrANrXUS&Da&vW", name: "Miura Kevin-Adrian", group: 163, driveFolder: "https://drive.google.com/drive/folders/1H3hJCoh0mt3vrr93c9xIpXBZmj9p9eyU?usp=sharing", tries: 3 },
  bmnan: { password: "M4nGgR6mxe%DwEP3", name: "Nan Bianca-Maria", group: 163, driveFolder: "https://drive.google.com/drive/folders/1vR5s-wU_rgN01zhzfb-4lYmxFq0epWjz?usp=sharing", tries: 3 },
  dtpetrovici: { password: "m*4?gV#r+!#e9GU4", name: "Petrovici Dalia-Teodora", group: 163, driveFolder: "https://drive.google.com/drive/folders/1bXw6U_J5lbZJj8Or23dHcZl73sAvjmkx?usp=drive_link", tries: 3 },
  iradu: { password: "&+sth!nz7aGuM%Xy", name: "Radu Ioana", group: 163, driveFolder: "https://drive.google.com/drive/folders/1NLRPx04jMcK2ItzqvT6TnXbiVwy0N4ie?usp=sharing", tries: 3 },
  cdrapiteanu: { password: "CK%QvpMb!bZH*?ff", name: "Răpițeanu Carol-David", group: 163, driveFolder: "https://drive.google.com/drive/folders/1lXR8sIkLPwGM4tuXKhIflSBWFaoRH1Uh?usp=sharing", tries: 3 },
  dsabo: { password: "Wd?4QzSY5a+q93+2", name: "Sabo David", group: 163, driveFolder: "https://drive.google.com/drive/folders/1bPHDiw-UNFyjYoBN07-9q3DKdCBXKOwm?usp=sharing", tries: 3 },
  gastefan: { password: "WS@zB$Q*!#CPc#EC", name: "Ștefan George-Alexandru", group: 163, driveFolder: "https://drive.google.com/drive/folders/1SCt2M42WE16UuWa4PGZdgz4mEj7jNdfj?usp=sharing", tries: 3 },
  dftatomir: { password: "P8?8%sybWXkJc?Ju", name: "Tatomir Darius-Flavius", group: 163, driveFolder: "https://drive.google.com/drive/folders/1e7GFwGKlQtODlKfiKkfLQCpY6T5gCpIu?usp=sharing", tries: 3 },
  matimbus: { password: "KYy+bxRnVUTsKmDW", name: "Timbuș Maria-Alexandra", group: 163, driveFolder: "https://drive.google.com/drive/folders/13A5UKCpsbakp-Uy2fN9X08wB9K6uO_uz?usp=sharing", tries: 3 },
  mftrandafir: { password: "Uzzyr3@wPsphA7nn", name: "Trandafir Mariana-Florentina", group: 163, driveFolder: "https://drive.google.com/drive/folders/1HZMRLk4Wrl4U2-EoKKLiXm-McmI5rCZ-?usp=sharing", tries: 3 },
  deungureanu: { password: "8f9WSygx%6sZbm9T", name: "Ungureanu David-Emanuel", group: 163, driveFolder: "https://drive.google.com/drive/folders/1hKAKfKZKDDikNnWNpjAVhc10g10ZruzC?usp=sharing", tries: 3 },
  aguillermo: { password: "+t3$K5DC+sCUtU$+", name: "Guillermo Alonso", group: 163, driveFolder: "https://drive.google.com/drive/folders/1VpzPjDAKtEz1VQ-wOmTDovIzAccujNOT?usp=sharing", tries: 3 },
  
  // Grupa 164
  cbaciu: { password: "&y4H7nKFmcVce5Fv", name: "Baciu Cristian", group: 164, driveFolder: "https://drive.google.com/drive/folders/1dfCS-iNjaer_TQLEpQKt7Ad6GeX9LXUB?usp=sharing", tries: 3 },
  ncbodescu: { password: "#@Z#PBqfrhaFaR3u", name: "Bodescu Nicoleta-Cătălina", group: 164, driveFolder: "https://drive.google.com/drive/folders/1zxgdv0Ebr3BThtUudmlfObsID5S4fzMZ?usp=sharing", tries: 3 },
  vcciunel: { password: "gUKkuv&kDTv&gY#5", name: "Ciunel Vlad Cristian", group: 164, driveFolder: "https://drive.google.com/drive/folders/1Hxljf6oXwWbeLPH8NqOBYBHaVpHiQuSa?usp=sharing", tries: 3 },
  vciuta: { password: "J$n#jZz@M73VP@SB", name: "Ciută Vasile", group: 164, driveFolder: "https://drive.google.com/drive/folders/1QdbQXPBnQV3xEHn_BtmjNcDvfhl77Hsc?usp=sharing", tries: 3 },
  dcraciun: { password: "r7wg?f#9r*KCPEXD", name: "Crăciun Daniel", group: 164, driveFolder: "https://drive.google.com/drive/folders/1QpIZRiUVzpWiqvD86lEq7kcoBO7ebwlk?usp=sharing", tries: 3 },
  camicu: { password: "h+Mqenyz&z%zXqHP", name: "Micu Cosmin-Andrei", group: 164, driveFolder: "https://drive.google.com/drive/folders/1SvBSQr0xS4uf8KZoHzq54p03bkQoPAj9?usp=sharing", tries: 3 },
  tcmurariu: { password: "R!2wE&zs!b+w%Ppf", name: "Murariu Tudor-Călin", group: 164, driveFolder: "https://drive.google.com/drive/folders/19V9NmCeY9n5SMvK2BnMVbkdEKviBFWC1?usp=sharing", tries: 3 },
  raneacsu: { password: "TRp#AaqsnneNW!6r", name: "Neacșu Rareș Andrei", group: 164, driveFolder: "https://drive.google.com/drive/folders/1K5CI3CRw5CBazC6maoxA4QBzJEEMX-q_?usp=sharing", tries: 3 },
  mnecula: { password: "rr4%34U2+2QmJqms", name: "Necula Matei", group: 164, driveFolder: "https://drive.google.com/drive/folders/1tMj4NHQPwdFm-mavZgKdaqyUfwQ4MTh1?usp=sharing", tries: 3 },
  lanedelcu: { password: "mwWenn4RPhCZH*4x", name: "Nedelcu Liviu-Adrian", group: 164, driveFolder: "https://drive.google.com/drive/folders/1GJJ7mHKQkz3nsU7OzJEzJgYkzgINNvsX?usp=sharing", tries: 3 },
  acoroian: { password: "8kG+Yb53QrtA+FQt", name: "Oroian Andrei-Cristian", group: 164, driveFolder: "https://drive.google.com/drive/folders/1THSAMGEjjU6xRr7_gp-ZrlLIYo8wd0jW?usp=sharing", tries: 3 },
  raplutu: { password: "%BwMsEr5C$*Wxch@", name: "Pluțu Robert-Adrian", group: 164, driveFolder: "https://drive.google.com/drive/folders/1g-Dcq6Q4F0ZtjU3A8VoDJZXOW6V737xD?usp=sharing", tries: 3 },
  parada: { password: "@?hgG58pr*fHA%xw", name: "Rada Patrick-Andrei", group: 164, driveFolder: "https://drive.google.com/drive/folders/1u7B0DsQ1Aea60Q362hCFwsFiipq5EAWw?usp=sharing", tries: 3 },
  aasalehi: { password: "UNm#3TFJ8e*@uf#5", name: "Salehi Arian-Andrei", group: 164, driveFolder: "https://drive.google.com/drive/folders/1VqHnTLK9s_uONw7_Zs3M1lxN8rpNJe0M?usp=sharing", tries: 3 },
  eosandupopa: { password: "U6DjK%6zruZ7anEw", name: "Sandu-Popa Eduard-Octavian", group: 164, driveFolder: "https://drive.google.com/drive/folders/1OVjoQ0ql08zr0PSqO8ouUVP23iUynKKE?usp=sharing", tries: 3 },
  cdstanica: { password: "+%Y@a+H3&Qdvf*d5", name: "Stănică Constantin-Dragoș", group: 164, driveFolder: "https://drive.google.com/drive/folders/10142BX8D74MskPPaG80PmeYrj8YUlfcp?usp=sharing", tries: 3 },
  sstoica: { password: "cvp-f4wAz5?G36xU", name: "Stoica Sara", group: 164, driveFolder: "https://drive.google.com/drive/folders/1vXAsV9BmxBs909nIO0v9W80vRSfZ1jHN?usp=sharing", tries: 3 },
  ttita: { password: "zUSPRtg%Zan?N9#S", name: "Tița Teodor", group: 164, driveFolder: "https://drive.google.com/drive/folders/1teC7cpqkpN31mphmDPw18OZOfk7XjCJR?usp=sharing", tries: 3 },
  msvisan: { password: "zMgC#TjrjxUY@x3g", name: "Vișan Miruna-Ștefania", group: 164, driveFolder: "https://drive.google.com/drive/folders/15itHuOVTjDxF6F7PeUOFKVlkwq6VDllL?usp=sharing", tries: 3 }
};

// --- GROUP PDFs ---
const GROUPS = {
  161: {
    theory: [
      "https://drive.google.com/file/d/1EXAMPLE_161_THEORY_1/preview",
      "https://drive.google.com/file/d/1EXAMPLE_161_THEORY_2/preview"
    ],
    ex: [
      "https://drive.google.com/file/d/1EXAMPLE_161_EX_1/preview",
      "https://drive.google.com/file/d/1EXAMPLE_161_EX_2/preview"
    ]
  },
  162: {
    theory: [
      "https://drive.google.com/file/d/1EXAMPLE_162_THEORY_1/preview",
      "https://drive.google.com/file/d/1EXAMPLE_162_THEORY_2/preview"
    ],
    ex: [
      "https://drive.google.com/file/d/1EXAMPLE_162_EX_1/preview",
      "https://drive.google.com/file/d/1EXAMPLE_162_EX_2/preview"
    ]
  },
  163: {
    theory: [
      "https://drive.google.com/file/d/1EXAMPLE_163_THEORY_1/preview",
      "https://drive.google.com/file/d/1EXAMPLE_163_THEORY_2/preview"
    ],
    ex: [
      "https://drive.google.com/file/d/1EXAMPLE_163_EX_1/preview",
      "https://drive.google.com/file/d/1EXAMPLE_163_EX_2/preview"
    ]
  },
  164: {
    theory: [
      "https://drive.google.com/file/d/1EXAMPLE_164_THEORY_1/preview",
      "https://drive.google.com/file/d/1EXAMPLE_164_THEORY_2/preview"
    ],
    ex: [
      "https://drive.google.com/file/d/1EXAMPLE_164_EX_1/preview",
      "https://drive.google.com/file/d/1EXAMPLE_164_EX_2/preview"
    ]
  }
};

// --- STATE ---
let currentUser=null;
let timers={theory:null,ex:null};
let remaining={theory:0,ex:0};
let finishedSections={theory:false,ex:false};
let startedAny=false;
let pdfListVisible=false;

// --- HELPERS ---
const $=id=>document.getElementById(id);
function usedAttemptsKey(username){return `usedAttempts_${username}`;}
function getUsedAttempts(username){return Number(localStorage.getItem(usedAttemptsKey(username))||0);}
function setUsedAttempts(username,n){localStorage.setItem(usedAttemptsKey(username),String(n));}
function saveState(){if(!currentUser)return; localStorage.setItem(`examState_${currentUser.username}`,JSON.stringify({remaining,finishedSections,startedAny}));}
function loadState(){if(!currentUser)return; const state=JSON.parse(localStorage.getItem(`examState_${currentUser.username}`)||'{}'); if(state){remaining=state.remaining||{theory:0,ex:0};finishedSections=state.finishedSections||{theory:false,ex:false};startedAny=state.startedAny||false;}}
function clearState(){if(currentUser)localStorage.removeItem(`examState_${currentUser.username}`);}
function formatTime(sec){const s=Math.max(0,Math.floor(sec));return String(Math.floor(s/60)).padStart(2,'0')+':'+String(s%60).padStart(2,'0');}

// --- LOGIN ---
function login(){
const u=$('username').value.trim(),p=$('password').value,info=USERS[u],err=$('loginError');err.textContent='';
if(!info||info.password!==p){err.textContent='Invalid username or password';return;}
if(u!=='admin' && info.tries!==null && getUsedAttempts(u)>=info.tries){err.textContent='No attempts left';return;}
currentUser={username:u,name:info.name,group:info.group,driveFolder:info.driveFolder,tries:info.tries};
$('login').classList.add('hidden');$('exam').classList.remove('hidden');
$('welcome').textContent=`Welcome ${currentUser.name} ${currentUser.group?"(Group "+currentUser.group+")":""}`;
updateAttemptsUI();
loadState();
resetExamUI();
$('adminPDFSection').style.display=(u==='admin')?'block':'none';
}

// --- LOGOUT ---
function logout(){clearInterval(timers.theory);clearInterval(timers.ex);currentUser=null;$('exam').classList.add('hidden');$('login').classList.remove('hidden');$('username').value='';$('password').value='';$('loginError').textContent='';$('attemptInfo').textContent='';$('adminPDFList').classList.add('hidden');pdfListVisible=false;}

// --- ATTEMPTS UI ---
function updateAttemptsUI(){if(!currentUser)return;let used=getUsedAttempts(currentUser.username);let max=currentUser.tries===null?"∞":currentUser.tries;$('attemptInfo').textContent=`Attempts used: ${used} / ${max}`;}

// --- REQUEST ACCESS ---
function requestAccess(){window.location.href='coming-soon.html';}

// --- RESET EXAM UI ---
function resetExamUI(){
['theory','ex'].forEach(s=>{
$(`start${s==='theory'?'Theory':'Ex'}`).classList.remove('hidden');
$(`${s}Timer`).style.display=remaining[s]>0?'inline':'none';
$(`${s}Timer`).textContent=formatTime(remaining[s]);
if(remaining[s]>0){const storedPdf=localStorage.getItem(`pdf_${currentUser.username}_${s}`);if(storedPdf){$(`${s}Pdf`).src=storedPdf;$(`${s}PdfContainer`).classList.remove('hidden');}}
$(`${s}Section`).classList.remove('fade-out');
});
$('finishExamContainer').style.display=startedAny?'block':'none';
$('uploadCard').classList.add('hidden');
// Disable exam if max attempts reached
if(currentUser.tries !== null && getUsedAttempts(currentUser.username)>=currentUser.tries){
['startTheory','startEx'].forEach(b=>$(b).style.display='none');
$('finishExamContainer').style.display='none';
$('hint').textContent='You have used all your attempts.';
}
}

// --- START TIMER ---
function startTimer(section){
if(!currentUser)return alert('Please log in first.');
let pdfs=[],duration=60;
if(currentUser.username==='admin'){
pdfs=[];
for(let gid in GROUPS){pdfs=pdfs.concat(GROUPS[gid][section]);}
duration=9999*60;
}else{
const gid=currentUser.group;
pdfs=GROUPS[gid][section];
duration=GROUPS[gid][section].length*60;
}
remaining[section]=remaining[section]>0?remaining[section]:duration;
$(`start${section==='theory'?'Theory':'Ex'}`).classList.add('hidden');
$(`${section}Timer`).style.display = currentUser.username==='admin'?'none':'inline';
if(pdfs.length>0){
const pdf=pdfs[Math.floor(Math.random()*pdfs.length)];
$(`${section}Pdf`).src=pdf;
$(`${section}PdfContainer`).classList.remove('hidden');
if(currentUser.username!=='admin') localStorage.setItem(`pdf_${currentUser.username}_${section}`,pdf);
}
startedAny=true;
$('finishExamContainer').style.display='block';
if(currentUser.username!=='admin'){
timers[section]=setInterval(()=>{
remaining[section]--;
$(`${section}Timer`).textContent=formatTime(remaining[section]);
saveState();
if(remaining[section]<=0){clearInterval(timers[section]);endSection(section);}
},1000);
}
}

// --- END SECTION ---
function endSection(section){finishedSections[section]=true;$(`${section}Section`).classList.add('fade-out');}

// --- FINISH EXAM ---
function finishExam(){
if(!currentUser)return;
if(currentUser.tries !== null){
let used=getUsedAttempts(currentUser.username)||0;
used++;
setUsedAttempts(currentUser.username,used);
updateAttemptsUI();
}
if(currentUser.username!=='admin'){
$('uploadName').textContent=`${currentUser.name} - Click below to upload your solutions`;
$('openFolderBtn').onclick=()=>{if(currentUser.driveFolder) window.open(currentUser.driveFolder,'_blank');};
$('uploadCard').classList.remove('hidden');
// Hide retake if maxed attempts
if(currentUser.tries !== null && getUsedAttempts(currentUser.username)>=currentUser.tries){
$('retakeBtn').style.display='none';
} else {
$('retakeBtn').style.display='inline-block';
}}
$('finishExamContainer').style.display='none';
['theory','ex'].forEach(s=>{clearInterval(timers[s]);$(`${s}PdfContainer`).classList.add('hidden');$(`${s}Pdf`).src='';$(`${s}Timer`).style.display='none';});
clearState();
}

// --- RETAKE EXAM ---
function resetPortal(){
if(currentUser.tries !== null && getUsedAttempts(currentUser.username)>=currentUser.tries){
alert("You have no attempts left.");
return;
}
remaining={theory:0,ex:0};
finishedSections={theory:false,ex:false};
startedAny=false;
clearState();
resetExamUI();
$('uploadCard').classList.add('hidden');
}

// --- ADMIN PDF LIST TOGGLE ---
function toggleAdminPDFList(){
const container=$('adminPDFList');
pdfListVisible=!pdfListVisible;
container.classList.toggle('hidden',!pdfListVisible);
$('togglePDFListBtn').textContent=pdfListVisible?'Close PDF List':'See PDF List';
if(pdfListVisible){
container.innerHTML='';
for(let gid in GROUPS){
const divGroup=document.createElement('div');
divGroup.className='mb-3 font-semibold';
divGroup.textContent=`Group ${gid}`;
container.appendChild(divGroup);
['theory','ex'].forEach(type=>{
const title=document.createElement('div');title.textContent=`${type.toUpperCase()}:`;title.className='ml-2 font-medium';container.appendChild(title);
GROUPS[gid][type].forEach(url=>{
const b=document.createElement('button');
b.textContent='View PDF';
b.className='ml-4 mt-1 px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 pdf-item';
b.onclick=()=>window.open(url,'_blank');
container.appendChild(b);
});
});
}
}
}
</script>
</body>
</html>

